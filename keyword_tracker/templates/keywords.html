{% extends "base.html" %}

{% block title %}PubMed Trend Checker{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('ktracker.static', filename='css/ktracker.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="container">

    <h2 class="header-title mb-4">【PubMed】キーワードトレンドチェッカー</h2>

    <div class="card p-4">
        <form method="POST">

            <div class="mb-3">
                <label class="form-label">検索キーワード（カンマ区切り）</label>
                <input type="text" class="form-control" name="keywords" value="{{ keywords_str }}" required>
            </div>

            <div class="mb-3">
                <label class="form-label">追跡期間 (週数)</label>
                <input type="number" class="form-control" name="weeks" min="1" max="52" value="{{ weeks }}">
            </div>

            <button type="submit" class="btn btn-green px-4 py-2 rounded-3">検索</button>
        </form>
    </div>

    {% if labels %}
    <div class="chart-container mt-4">
        <canvas id="weeklyChart"></canvas>
    </div>
    {% endif %}

</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('ktracker.static', filename='js/ktracker.js') }}"></script>
<script>
{% if labels %}
    drawTrendChart(
        {{ labels | tojson }},
        {{ values | tojson }},
        "{{ keywords_str }}"
    );
{% endif %}
</script>
{% endblock %}
